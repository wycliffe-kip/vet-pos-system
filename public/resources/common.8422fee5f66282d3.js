"use strict";(self.webpackChunkvet_pos_dev=self.webpackChunkvet_pos_dev||[]).push([[76],{7175:(C,_,i)=>{i.d(_,{$:()=>f});let d="development",a="",c="",h="",m="",g="",p=!1;if(d="localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname?"development":"production","development"===d)a="http://vetpos.local:84",c=`${a}/public/`,h=`${a}/public/mis/`,m="DEV_SITE_KEY",g=`${a}/public/payment`,p=!1;else if("production"===d){const u=window.location.protocol,y=window.location.hostname,o=window.location.port?":"+window.location.port:"";a=`${u}//${y}${o}`,c=`${a}/public/resources/`,h=`${u}//${y}${o}/mis/`,m="PRODUCTION_SITE_KEY",g=`${a}/payment`,p=!0}let f=(()=>{class u{static{this.base_url=a}static{this.assets_url=c}static{this.mis_url=h}static{this.siteKey=m}static{this.paymentUrl=g}static{this.apiUrl=`${a}/api`}static{this.environment=d}static{this.production=p}}return u})()},8010:(C,_,i)=>{i.d(_,{u:()=>f});var d=i(4412),a=i(8810),c=i(8141),h=i(9437),m=i(6354),v=i(7175),g=i(4438),p=i(1626);let f=(()=>{class u{constructor(o){this.http=o,this._user$=new d.t(null),this.apiUrl=`${v.$.apiUrl}/auth`,this.navigationReloadSource=new d.t(!1),this.navigationReload$=this.navigationReloadSource.asObservable();const r=localStorage.getItem("user");r&&this._user$.next(JSON.parse(r))}get user$(){return this._user$.asObservable()}setUser(o){this._user$.next(o),localStorage.setItem("user",JSON.stringify(o)),localStorage.setItem("roles",JSON.stringify(o.roles||[])),localStorage.setItem("permissions",JSON.stringify(o.permissions||[])),o.token&&localStorage.setItem("token",o.token)}get currentUser(){return this._user$.value}login(o){return this.http.post(`${this.apiUrl}/login`,o).pipe((0,c.M)(r=>{if("success"===r.status&&r.data?.user&&r.data?.token){const $={...r.data.user.user,roles:r.data.user.roles,permissions:r.data.user.permissions,token:r.data.token};localStorage.setItem("user",JSON.stringify($)),localStorage.setItem("token",r.data.token),this._user$.next($)}}),(0,h.W)(r=>(0,a.$)(()=>r)))}getToken(){return localStorage.getItem("token")}storeUser(o){localStorage.setItem("user",JSON.stringify(o)),o.token&&localStorage.setItem("token",o.token),this._user$.next(o)}me(){return this.http.get(`${this.apiUrl}/me`).pipe((0,c.M)(o=>{o?.user&&this.storeUser(o.user)}),(0,m.T)(o=>o?.user??null),(0,h.W)(o=>(console.warn("Failed to fetch profile:",o),this.clearSession(),(0,a.$)(()=>o))))}logout(){return this.http.post(`${this.apiUrl}/logout`,{}).pipe((0,c.M)(()=>this.clearSession()),(0,h.W)(o=>(console.warn("Logout failed, clearing local session anyway"),this.clearSession(),(0,a.$)(()=>o))))}register(o){return this.http.post(`${this.apiUrl}/register`,o).pipe((0,h.W)(r=>(0,a.$)(()=>r)))}forgotPassword(o){return this.http.post(`${this.apiUrl}/forgot-password`,o).pipe((0,h.W)(r=>(0,a.$)(()=>r)))}isAuthenticated(){return!!localStorage.getItem("token")}clearSession(){localStorage.removeItem("token"),localStorage.removeItem("user"),this._user$.next(null)}getCurrentUser(){const o=localStorage.getItem("user");return o?JSON.parse(o):null}getUserId(){const o=this.getCurrentUser();return o?o.id:null}getRoles(){const o=localStorage.getItem("roles");return o?JSON.parse(o):[]}getPermissions(){const o=localStorage.getItem("permissions");return o?JSON.parse(o):[]}triggerNavigationReload(){this.navigationReloadSource.next(!0)}hasPermission(o){return((this.currentUser||JSON.parse(localStorage.getItem("user")||"{}"))?.permissions||[]).includes(o)}static{this.\u0275fac=function(r){return new(r||u)(g.KVO(p.Qq))}}static{this.\u0275prov=g.jDH({token:u,factory:u.\u0275fac,providedIn:"root"})}}return u})()},8382:(C,_,i)=>{i.d(_,{N:()=>h,f:()=>c});var d=i(1349),a=i(7184);const c=function(m,v,g){const p=(0,a.A)(m),f=g?p.scrollLeft():p.scrollTop(),u=g?"Width":"Height",r=p.prop(`scroll${u}`)-p.prop(`client${u}`)-f|0;return(0!==f||0!==r)&&(!!(0===f&&v>=0||0===r&&v<=0||f>0&&r>0)||void 0)},h=function(m,v){const g=(0,a.A)(m);return{validate(p){if((0,d.X1)(p)&&(!v||(0,a.A)(p.target).is(m)))return!!c(g,-p.delta,p.shiftKey)&&(p._needSkipEvent=!0,!0)}}}},9172:(C,_,i)=>{i.d(_,{A:()=>Y});var d=i(8168),a=i(7184),c=i(2463),h=i(7276),m=i(4435),v=i(6676),g=i(5767),p=i(5632),f=i(7669),u=i(2535),y=i(4460),o=i(1299);const L=["info","warning","error","success"],E=[],R={top:{my:"top",at:"top",of:null,offset:"0 0"},bottom:{my:"bottom",at:"bottom",of:null,offset:"0 -20"},center:{my:"center",at:"center",of:null,offset:"0 0"},right:{my:"center right",at:"center right",of:null,offset:"0 0"},left:{my:"center left",at:"center left",of:null,offset:"0 0"}},H={h:0,v:0};(0,u.A.add)(()=>{const t=f.A.getDocument();v.A.subscribeGlobal(t,g.A.down,e=>{for(let n=E.length-1;n>=0;n-=1){var s,l;if(null===(s=(l=E[n])._proxiedDocumentDownHandler)||void 0===s||!s.call(l,e))return}})});class P extends y.A{_getDefaultOptions(){return(0,d.A)({},super._getDefaultOptions(),{message:"",type:"info",displayTime:2e3,position:"bottom center",animation:{show:{type:"fade",duration:400,from:0,to:1},hide:{type:"fade",duration:400,from:1,to:0}},shading:!1,height:"auto",hideTopOverlayHandler:null,preventScrollEvents:!1,closeOnSwipe:!0,closeOnClick:!1})}_defaultOptionsRules(){const e={displayTime:(0,o.Nt)((0,o.ss)())?4e3:2e3,hideOnOutsideClick:!0,animation:{show:{type:"fade",duration:200,from:0,to:1},hide:{type:"fade",duration:200,from:1,to:0}}},s=[{device:n=>"phone"===n.deviceType,options:(0,d.A)({width:"calc(100vw - 40px)"},e)},{device:n=>"tablet"===n.deviceType,options:(0,d.A)({width:"auto",maxWidth:"80vw"},e)},{device:n=>(0,o.Nt)((0,o.ss)())&&"desktop"===n.deviceType,options:{minWidth:344,maxWidth:568,displayTime:4e3}}];return[...super._defaultOptionsRules(),...s]}_init(){super._init(),this._posStringToObject()}_renderContentImpl(){const{message:e,type:s}=this.option();return this._message=(0,a.A)("<div>").addClass("dx-toast-message").text(e??"").appendTo(this.$content()),this.setAria("role","alert",this._message),s&&L.includes(s.toLowerCase())&&this.$content().prepend((0,a.A)("<div>").addClass("dx-toast-icon")),super._renderContentImpl()}_render(){super._render(),this.$element().addClass("dx-toast"),this.$wrapper().addClass("dx-toast-wrapper");const{type:e}=this.option();e&&this.$content().addClass(`dx-toast-${e.toLowerCase()}`),this.$content().addClass("dx-toast-content"),this._toggleCloseEvents("Swipe"),this._toggleCloseEvents("Click")}_toggleCloseEvents(e){const s=`dx${e.toLowerCase()}`;v.A.off(this.$content(),s),this.option(`closeOn${e}`)&&v.A.on(this.$content(),s,this.hide.bind(this))}_posStringToObject(){const{position:e}=this.option();if(!(0,c.Kg)(e))return;const s=e.split(" ")[0],l=e.split(" ")[1],n=(0,d.A)({boundaryOffset:H},R[s]);switch(this.option("position",n),l){case"center":case"left":case"right":if(n&&"object"==typeof n){const O=`${n.my} ${l}`;this.option("position.at",`${n.at} ${l}`),this.option("position.my",O)}}}_show(){const e=super._show();return e.always(()=>{clearTimeout(this._hideTimeout);const{displayTime:s}=this.option();this._hideTimeout=setTimeout(this.hide.bind(this),s)}),e}_overlayStack(){return E}_zIndexInitValue(){return super._zIndexInitValue()+8e3}_dispose(){clearTimeout(this._hideTimeout),super._dispose()}_optionChanged(e){const{name:s,value:l,previousValue:n}=e;switch(s){case"type":this.$content().removeClass(`dx-toast-${n}`),l&&this.$content().addClass(`dx-toast-${String(l).toLowerCase()}`);break;case"message":this._message&&this._message.text(l);break;case"closeOnSwipe":this._toggleCloseEvents("Swipe");break;case"closeOnClick":this._toggleCloseEvents("Click");break;case"displayTime":break;default:super._optionChanged(e)}}}(0,p.A)("dxToast",P);const k=P,W=(0,m.zk)();let M=null;const U={},b={"top left":{top:10,left:10},"top right":{top:10,right:10},"bottom left":{bottom:10,left:10},"bottom right":{bottom:10,right:10},"top center":t=>({top:10,left:Math.round(t.windowWidth/2-t.toastWidth/2)}),"left center":t=>({top:Math.round(t.windowHeight/2-t.toastHeight/2),left:10}),"right center":t=>({top:Math.round(t.windowHeight/2-t.toastHeight/2),right:10}),center:t=>({top:Math.round(t.windowHeight/2-t.toastHeight/2),left:Math.round(t.windowWidth/2-t.toastWidth/2)}),"bottom center":t=>({bottom:10,left:Math.round(t.windowWidth/2-t.toastWidth/2)})},K={up:(t,e)=>({bottom:t.bottom??e.windowHeight-e.toastHeight-(t.top??0),top:"",left:t.left??"",right:t.right??""}),down:(t,e)=>({top:t.top??e.windowHeight-e.toastHeight-(t.bottom??0),bottom:"",left:t.left??"",right:t.right??""}),left:(t,e)=>({right:t.right??e.windowWidth-e.toastWidth-(t.left??0),left:"",top:t.top??"",bottom:t.bottom??""}),right:(t,e)=>({left:t.left??e.windowWidth-e.toastWidth-(t.right??0),right:"",top:t.top??"",bottom:t.bottom??""})},Q=(t,e,s)=>{const l=(0,c.Qd)(t)?t:{message:t},n=(0,c.Qd)(e)?e:void 0,w=(0,c.Qd)(e)?void 0:e,{onHidden:O,onShowing:T}=l,A={onHidden:S=>{(0,a.A)(S.element).remove(),O?.(S)}};if(void 0!==w&&(A.type=w),void 0!==s&&(A.displayTime=s),null!=n&&n.position){const{position:S}=n,N=n.direction||(t=>(0,c.Kg)(t)&&t.includes("top")?"down-push":"up-push")(S),I=(t=>U[t]||(t=>{const e=(0,a.A)("<div>").appendTo((0,h.Uq)());return U[t]=e,e})(t))((0,c.Kg)(S)?S:`${S.top}-${S.left}-${S.bottom}-${S.right}`);return((t,e)=>{const s=`dx-toast-stack dx-toast-stack-${e}-direction`;t.removeAttr("class").addClass(s)})(I,N),(0,d.A)({},l,A,{container:I,_skipContentPositioning:!0,onShowing:Z=>{((t,e,s)=>{const{offsetWidth:l,offsetHeight:n}=t.children().first().get(0),w={toastWidth:l,toastHeight:n,windowHeight:W.innerHeight,windowWidth:W.innerWidth},O=(0,c.Kg)(s)?((t,e)=>{const s=t?b[t]:b["bottom center"];return"function"==typeof s?s(e):s})(s,w):s,T=((t,e,s)=>{const l=t.replace(/-push|-stack/g,""),n=K[l];return n?n(e,s):{top:"",bottom:"",left:"",right:""}})(e,O,w);t.css(T)})(I,N,S),T?.(Z)}})}return(0,d.A)({},l,A)},Y=(t,e,s)=>{const l=Q(t,e,s);M=(0,a.A)("<div>").appendTo((0,h.Uq)()),new k(M,l).show()}}}]);