"use strict";(self.webpackChunkvet_pos_dev=self.webpackChunkvet_pos_dev||[]).push([[76],{7175:(I,w,i)=>{i.d(w,{$:()=>_});let c="development",l="",d="",p="",m="",g="",f=!1;if(c="localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname?"development":"production","development"===c)l="http://vetpos.local:84",d=`${l}/public/`,p=`${l}/public/mis/`,m="DEV_SITE_KEY",g=`${l}/public/payment`,f=!1;else if("production"===c){const h=window.location.protocol,O=window.location.hostname,e=window.location.port?":"+window.location.port:"";l=`${h}//${O}${e}`,d=`${l}/public/resources/`,p=`${h}//${O}${e}/mis/`,m="PRODUCTION_SITE_KEY",g=`${l}/payment`,f=!0}let _=(()=>{class h{static{this.base_url=l}static{this.assets_url=d}static{this.mis_url=p}static{this.siteKey=m}static{this.paymentUrl=g}static{this.apiUrl=`${l}/api`}static{this.environment=c}static{this.production=f}}return h})()},8010:(I,w,i)=>{i.d(w,{u:()=>_});var c=i(4412),l=i(8810),d=i(8141),p=i(9437),m=i(6354),y=i(7175),g=i(4438),f=i(1626);let _=(()=>{class h{constructor(e){this.http=e,this._user$=new c.t(null),this.apiUrl=`${y.$.apiUrl}/auth`,this.navigationReloadSource=new c.t(!1),this.navigationReload$=this.navigationReloadSource.asObservable();const a=localStorage.getItem("user");a&&this._user$.next(JSON.parse(a))}get user$(){return this._user$.asObservable()}setUser(e){this._user$.next(e),localStorage.setItem("user",JSON.stringify(e)),localStorage.setItem("roles",JSON.stringify(e.roles||[])),localStorage.setItem("permissions",JSON.stringify(e.permissions||[])),e.token&&localStorage.setItem("token",e.token)}get currentUser(){return this._user$.value}login(e){return this.http.post(`${this.apiUrl}/login`,e).pipe((0,d.M)(a=>{if("success"===a.status&&a.data?.user&&a.data?.token){const C={...a.data.user.user,roles:a.data.user.roles,permissions:a.data.user.permissions,token:a.data.token};localStorage.setItem("user",JSON.stringify(C)),localStorage.setItem("token",a.data.token),this._user$.next(C)}}),(0,p.W)(a=>(0,l.$)(()=>a)))}getToken(){return localStorage.getItem("token")}storeUser(e){localStorage.setItem("user",JSON.stringify(e)),e.token&&localStorage.setItem("token",e.token),this._user$.next(e)}me(){return this.http.get(`${this.apiUrl}/me`).pipe((0,d.M)(e=>{e?.user&&this.storeUser(e.user)}),(0,m.T)(e=>e?.user??null),(0,p.W)(e=>(console.warn("Failed to fetch profile:",e),this.clearSession(),(0,l.$)(()=>e))))}logout(){return this.http.post(`${this.apiUrl}/logout`,{}).pipe((0,d.M)(()=>this.clearSession()),(0,p.W)(e=>(console.warn("Logout failed, clearing local session anyway"),this.clearSession(),(0,l.$)(()=>e))))}register(e){return this.http.post(`${this.apiUrl}/register`,e).pipe((0,p.W)(a=>(0,l.$)(()=>a)))}forgotPassword(e){return this.http.post(`${this.apiUrl}/forgot-password`,e).pipe((0,p.W)(a=>(0,l.$)(()=>a)))}isAuthenticated(){return!!localStorage.getItem("token")}clearSession(){localStorage.removeItem("token"),localStorage.removeItem("user"),this._user$.next(null)}getCurrentUser(){const e=localStorage.getItem("user");return e?JSON.parse(e):null}getUserId(){const e=this.getCurrentUser();return e?e.id:null}getRoles(){const e=localStorage.getItem("roles");return e?JSON.parse(e):[]}getPermissions(){const e=localStorage.getItem("permissions");return e?JSON.parse(e):[]}triggerNavigationReload(){this.navigationReloadSource.next(!0)}hasPermission(e){return((this.currentUser||JSON.parse(localStorage.getItem("user")||"{}"))?.permissions||[]).includes(e)}static{this.\u0275fac=function(a){return new(a||h)(g.KVO(f.Qq))}}static{this.\u0275prov=g.jDH({token:h,factory:h.\u0275fac,providedIn:"root"})}}return h})()},9172:(I,w,i)=>{i.d(w,{A:()=>G});var c=i(8168),l=i(7184),d=i(2463),p=i(7276),m=i(4435),y=i(6676),g=i(5767),f=i(5632),_=i(7669),h=i(2535),O=i(4460),e=i(1299);const P=["info","warning","error","success"],A=[],N={top:{my:"top",at:"top",of:null,offset:"0 0"},bottom:{my:"bottom",at:"bottom",of:null,offset:"0 -20"},center:{my:"center",at:"center",of:null,offset:"0 0"},right:{my:"center right",at:"center right",of:null,offset:"0 0"},left:{my:"center left",at:"center left",of:null,offset:"0 0"}},R={h:0,v:0};(0,h.A.add)(()=>{const t=_.A.getDocument();y.A.subscribeGlobal(t,g.A.down,o=>{for(let n=A.length-1;n>=0;n-=1){var s,r;if(null===(s=(r=A[n])._proxiedDocumentDownHandler)||void 0===s||!s.call(r,o))return}})});class x extends O.A{_getDefaultOptions(){return(0,c.A)({},super._getDefaultOptions(),{message:"",type:"info",displayTime:2e3,position:"bottom center",animation:{show:{type:"fade",duration:400,from:0,to:1},hide:{type:"fade",duration:400,from:1,to:0}},shading:!1,height:"auto",hideTopOverlayHandler:null,preventScrollEvents:!1,closeOnSwipe:!0,closeOnClick:!1})}_defaultOptionsRules(){const o={displayTime:(0,e.Nt)((0,e.ss)())?4e3:2e3,hideOnOutsideClick:!0,animation:{show:{type:"fade",duration:200,from:0,to:1},hide:{type:"fade",duration:200,from:1,to:0}}},s=[{device:n=>"phone"===n.deviceType,options:(0,c.A)({width:"calc(100vw - 40px)"},o)},{device:n=>"tablet"===n.deviceType,options:(0,c.A)({width:"auto",maxWidth:"80vw"},o)},{device:n=>(0,e.Nt)((0,e.ss)())&&"desktop"===n.deviceType,options:{minWidth:344,maxWidth:568,displayTime:4e3}}];return[...super._defaultOptionsRules(),...s]}_init(){super._init(),this._posStringToObject()}_renderContentImpl(){const{message:o,type:s}=this.option();return this._message=(0,l.A)("<div>").addClass("dx-toast-message").text(o??"").appendTo(this.$content()),this.setAria("role","alert",this._message),s&&P.includes(s.toLowerCase())&&this.$content().prepend((0,l.A)("<div>").addClass("dx-toast-icon")),super._renderContentImpl()}_render(){super._render(),this.$element().addClass("dx-toast"),this.$wrapper().addClass("dx-toast-wrapper");const{type:o}=this.option();o&&this.$content().addClass(`dx-toast-${o.toLowerCase()}`),this.$content().addClass("dx-toast-content"),this._toggleCloseEvents("Swipe"),this._toggleCloseEvents("Click")}_toggleCloseEvents(o){const s=`dx${o.toLowerCase()}`;y.A.off(this.$content(),s),this.option(`closeOn${o}`)&&y.A.on(this.$content(),s,this.hide.bind(this))}_posStringToObject(){const{position:o}=this.option();if(!(0,d.Kg)(o))return;const s=o.split(" ")[0],r=o.split(" ")[1],n=(0,c.A)({boundaryOffset:R},N[s]);switch(this.option("position",n),r){case"center":case"left":case"right":if(n&&"object"==typeof n){const S=`${n.my} ${r}`;this.option("position.at",`${n.at} ${r}`),this.option("position.my",S)}}}_show(){const o=super._show();return o.always(()=>{clearTimeout(this._hideTimeout);const{displayTime:s}=this.option();this._hideTimeout=setTimeout(this.hide.bind(this),s)}),o}_overlayStack(){return A}_zIndexInitValue(){return super._zIndexInitValue()+8e3}_dispose(){clearTimeout(this._hideTimeout),super._dispose()}_optionChanged(o){const{name:s,value:r,previousValue:n}=o;switch(s){case"type":this.$content().removeClass(`dx-toast-${n}`),r&&this.$content().addClass(`dx-toast-${String(r).toLowerCase()}`);break;case"message":this._message&&this._message.text(r);break;case"closeOnSwipe":this._toggleCloseEvents("Swipe");break;case"closeOnClick":this._toggleCloseEvents("Click");break;case"displayTime":break;default:super._optionChanged(o)}}}(0,f.A)("dxToast",x);const L=x,b=(0,m.zk)();let D=null;const U={},W={"top left":{top:10,left:10},"top right":{top:10,right:10},"bottom left":{bottom:10,left:10},"bottom right":{bottom:10,right:10},"top center":t=>({top:10,left:Math.round(t.windowWidth/2-t.toastWidth/2)}),"left center":t=>({top:Math.round(t.windowHeight/2-t.toastHeight/2),left:10}),"right center":t=>({top:Math.round(t.windowHeight/2-t.toastHeight/2),right:10}),center:t=>({top:Math.round(t.windowHeight/2-t.toastHeight/2),left:Math.round(t.windowWidth/2-t.toastWidth/2)}),"bottom center":t=>({bottom:10,left:Math.round(t.windowWidth/2-t.toastWidth/2)})},k={up:(t,o)=>({bottom:t.bottom??o.windowHeight-o.toastHeight-(t.top??0),top:"",left:t.left??"",right:t.right??""}),down:(t,o)=>({top:t.top??o.windowHeight-o.toastHeight-(t.bottom??0),bottom:"",left:t.left??"",right:t.right??""}),left:(t,o)=>({right:t.right??o.windowWidth-o.toastWidth-(t.left??0),left:"",top:t.top??"",bottom:t.bottom??""}),right:(t,o)=>({left:t.left??o.windowWidth-o.toastWidth-(t.right??0),right:"",top:t.top??"",bottom:t.bottom??""})},z=(t,o,s)=>{const r=(0,d.Qd)(t)?t:{message:t},n=(0,d.Qd)(o)?o:void 0,v=(0,d.Qd)(o)?void 0:o,{onHidden:S,onShowing:$}=r,T={onHidden:u=>{(0,l.A)(u.element).remove(),S?.(u)}};if(void 0!==v&&(T.type=v),void 0!==s&&(T.displayTime=s),null!=n&&n.position){const{position:u}=n,M=n.direction||(t=>(0,d.Kg)(t)&&t.includes("top")?"down-push":"up-push")(u),E=(t=>U[t]||(t=>{const o=(0,l.A)("<div>").appendTo((0,p.Uq)());return U[t]=o,o})(t))((0,d.Kg)(u)?u:`${u.top}-${u.left}-${u.bottom}-${u.right}`);return((t,o)=>{const s=`dx-toast-stack dx-toast-stack-${o}-direction`;t.removeAttr("class").addClass(s)})(E,M),(0,c.A)({},r,T,{container:E,_skipContentPositioning:!0,onShowing:Y=>{((t,o,s)=>{const{offsetWidth:r,offsetHeight:n}=t.children().first().get(0),v={toastWidth:r,toastHeight:n,windowHeight:b.innerHeight,windowWidth:b.innerWidth},S=(0,d.Kg)(s)?((t,o)=>{const s=t?W[t]:W["bottom center"];return"function"==typeof s?s(o):s})(s,v):s,$=((t,o,s)=>{const r=t.replace(/-push|-stack/g,""),n=k[r];return n?n(o,s):{top:"",bottom:"",left:"",right:""}})(o,S,v);t.css($)})(E,M,u),$?.(Y)}})}return(0,c.A)({},r,T)},G=(t,o,s)=>{const r=z(t,o,s);D=(0,l.A)("<div>").appendTo((0,p.Uq)()),new L(D,r).show()}}}]);