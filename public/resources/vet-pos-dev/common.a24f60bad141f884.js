"use strict";(self.webpackChunkvet_pos_dev=self.webpackChunkvet_pos_dev||[]).push([[76],{7175:(C,_,n)=>{n.d(_,{$:()=>T});let u="development",r="",l="",p="",f="",m="",g=!1;if(u="localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname?"development":"production","development"===u)r="http://vetpos.local:84",l=`${r}/public/`,p=`${r}/public/mis/`,f="DEV_SITE_KEY",m=`${r}/public/payment`,g=!1;else if("production"===u){const t=window.location.protocol,i=window.location.hostname,e=window.location.port?":"+window.location.port:"";r=`${t}//${i}${e}`,l=`${r}/public/resources/`,p=`${t}//${i}${e}/mis/`,f="PRODUCTION_SITE_KEY",m=`${r}/payment`,g=!0}let T=(()=>{class t{static{this.base_url=r}static{this.assets_url=l}static{this.mis_url=p}static{this.siteKey=f}static{this.paymentUrl=m}static{this.apiUrl=`${r}/api`}static{this.environment=u}static{this.production=g}}return t})()},8010:(C,_,n)=>{n.d(_,{u:()=>T});var u=n(4412),r=n(8810),l=n(8141),p=n(9437),f=n(6354),v=n(7175),m=n(4438),g=n(1626);let T=(()=>{class t{constructor(e){this.http=e,this._user$=new u.t(null),this.apiUrl=`${v.$.apiUrl}/auth`,this.navigationReloadSource=new u.t(!1),this.navigationReload$=this.navigationReloadSource.asObservable();const c=localStorage.getItem("user");c&&this._user$.next(JSON.parse(c))}get user$(){return this._user$.asObservable()}setUser(e){this._user$.next(e),localStorage.setItem("user",JSON.stringify(e)),localStorage.setItem("roles",JSON.stringify(e.roles||[])),localStorage.setItem("permissions",JSON.stringify(e.permissions||[])),e.token&&localStorage.setItem("token",e.token)}get currentUser(){return this._user$.value}login(e){return this.http.post(`${this.apiUrl}/login`,e).pipe((0,l.M)(c=>{if("success"===c.status&&c.data?.user&&c.data?.token){const y={...c.data.user.user,roles:c.data.user.roles,permissions:c.data.user.permissions,token:c.data.token};localStorage.setItem("user",JSON.stringify(y)),localStorage.setItem("token",c.data.token),this._user$.next(y)}}),(0,p.W)(c=>(0,r.$)(()=>c)))}getToken(){return localStorage.getItem("token")}storeUser(e){localStorage.setItem("user",JSON.stringify(e)),e.token&&localStorage.setItem("token",e.token),this._user$.next(e)}me(){return this.http.get(`${this.apiUrl}/me`).pipe((0,l.M)(e=>{e?.user&&this.storeUser(e.user)}),(0,f.T)(e=>e?.user??null),(0,p.W)(e=>(console.warn("Failed to fetch profile:",e),this.clearSession(),(0,r.$)(()=>e))))}logout(){return this.http.post(`${this.apiUrl}/logout`,{}).pipe((0,l.M)(()=>this.clearSession()),(0,p.W)(e=>(console.warn("Logout failed, clearing local session anyway"),this.clearSession(),(0,r.$)(()=>e))))}register(e){return this.http.post(`${this.apiUrl}/register`,e).pipe((0,p.W)(c=>(0,r.$)(()=>c)))}forgotPassword(e){return this.http.post(`${this.apiUrl}/forgot-password`,e).pipe((0,p.W)(c=>(0,r.$)(()=>c)))}isAuthenticated(){return!!localStorage.getItem("token")}clearSession(){localStorage.removeItem("token"),localStorage.removeItem("user"),this._user$.next(null)}getCurrentUser(){const e=localStorage.getItem("user");return e?JSON.parse(e):null}getUserId(){const e=this.getCurrentUser();return e?e.id:null}getRoles(){const e=localStorage.getItem("roles");return e?JSON.parse(e):[]}getPermissions(){const e=localStorage.getItem("permissions");return e?JSON.parse(e):[]}triggerNavigationReload(){this.navigationReloadSource.next(!0)}hasPermission(e){return((this.currentUser||JSON.parse(localStorage.getItem("user")||"{}"))?.permissions||[]).includes(e)}static{this.\u0275fac=function(c){return new(c||t)(m.KVO(g.Qq))}}static{this.\u0275prov=m.jDH({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})()},5993:(C,_,n)=>{n.d(_,{c:()=>m});var u=n(1626),r=n(8810),l=n(6354),p=n(9437),f=n(7175),v=n(4438);let m=(()=>{class g{constructor(t){this.http=t,this.api=`${f.$.apiUrl}/inventory`}getConfigTables(){return this.http.get(`${this.api}/getConfigurationTables`)}loadConfig(t){return this.http.get(`${this.api}/loadConfig`,{params:{table_name:t}})}saveConfig(t){return this.http.post(`${this.api}/saveConfig`,t)}deleteConfig(t,i){return this.http.post(`${this.api}/deleteConfig/${i}`,{table_name:t})}getTableColumns(t){let i=(new u.Nl).set("table_name",t);return this.http.get(`${this.api}/getTableColumns`,{params:i})}list(){return this.http.get(`${this.api}`).pipe((0,l.T)(t=>t.data||[]),(0,p.W)(t=>(0,r.$)(()=>t)))}get(t){return this.http.get(`${this.api}/${t}`).pipe((0,l.T)(i=>i.data),(0,p.W)(i=>(0,r.$)(()=>i)))}create(t){return FormData,this.http.post(`${this.api}`,t).pipe((0,l.T)(i=>i.data),(0,p.W)(i=>(0,r.$)(()=>i)))}saveProduct(t){return this.http.post(`${this.api}/saveProduct`,t).pipe((0,l.T)(i=>i.data),(0,p.W)(this.handleError))}deleteProduct(t){return this.http.delete(`${this.api}/${t}`).pipe((0,p.W)(this.handleError))}update(t,i){return i instanceof FormData?this.http.post(`${this.api}/${t}?_method=PUT`,i).pipe((0,l.T)(e=>e.data),(0,p.W)(e=>(0,r.$)(()=>e))):this.http.put(`${this.api}/${t}`,i).pipe((0,l.T)(e=>e.data),(0,p.W)(e=>(0,r.$)(()=>e)))}delete(t){return this.http.delete(`${this.api}/${t}`).pipe((0,p.W)(i=>(0,r.$)(()=>i)))}lowStockProducts(t=10){return this.http.get(`${this.api}/low-stock?limit=${t}`).pipe((0,l.T)(i=>i.data||[]),(0,p.W)(i=>(0,r.$)(()=>i)))}adjustStock(t,i,e,c){return this.http.post(`${this.api}/${t}/adjust-stock`,{delta:i,reason:e,user:c}).pipe((0,l.T)(A=>A),(0,p.W)(A=>(0,r.$)(()=>A)))}addNewStock(t,i){return this.http.post(`${this.api}/${t}/add-stock`,i).pipe((0,l.T)(e=>e?.data??e),(0,p.W)(e=>(0,r.$)(()=>e)))}getStockHistory(t){return this.http.get(`${this.api}/${t}/history`).pipe((0,l.T)(i=>i.data||[]),(0,p.W)(i=>(0,r.$)(()=>i)))}getHistory(t){return this.http.get(`${this.api}/${t}/history`).pipe((0,l.T)(i=>i.data||[]),(0,p.W)(i=>(0,r.$)(()=>i)))}getCategories(){return this.http.get(`${this.api}/categories`).pipe((0,l.T)(t=>t?.data??[]),(0,p.W)(t=>(console.error("Error fetching categories",t),(0,r.$)(()=>t))))}getUnits(){return this.http.get(`${this.api}/units`).pipe((0,l.T)(t=>t?.data??[]),(0,p.W)(t=>(console.error("Error fetching units",t),(0,r.$)(()=>t))))}getPurchaseHistory(t){return this.http.get(`${this.api}/${t}/purchase-history`).pipe((0,l.T)(i=>i.data||[]),(0,p.W)(i=>(0,r.$)(()=>i)))}handleError(t){return console.error("InventoryService error:",t),(0,r.$)(()=>t)}static{this.\u0275fac=function(i){return new(i||g)(v.KVO(u.Qq))}}static{this.\u0275prov=v.jDH({token:g,factory:g.\u0275fac,providedIn:"root"})}}return g})()},9172:(C,_,n)=>{n.d(_,{A:()=>G});var u=n(8168),r=n(7184),l=n(2463),p=n(7276),f=n(4435),v=n(6676),m=n(5767),g=n(5632),T=n(7669),t=n(2535),i=n(4460),e=n(1299);const N=["info","warning","error","success"],I=[],R={top:{my:"top",at:"top",of:null,offset:"0 0"},bottom:{my:"bottom",at:"bottom",of:null,offset:"0 -20"},center:{my:"center",at:"center",of:null,offset:"0 0"},right:{my:"center right",at:"center right",of:null,offset:"0 0"},left:{my:"center left",at:"center left",of:null,offset:"0 0"}},L={h:0,v:0};(0,t.A.add)(()=>{const o=T.A.getDocument();v.A.subscribeGlobal(o,m.A.down,s=>{for(let h=I.length-1;h>=0;h-=1){var a,d;if(null===(a=(d=I[h])._proxiedDocumentDownHandler)||void 0===a||!a.call(d,s))return}})});class P extends i.A{_getDefaultOptions(){return(0,u.A)({},super._getDefaultOptions(),{message:"",type:"info",displayTime:2e3,position:"bottom center",animation:{show:{type:"fade",duration:400,from:0,to:1},hide:{type:"fade",duration:400,from:1,to:0}},shading:!1,height:"auto",hideTopOverlayHandler:null,preventScrollEvents:!1,closeOnSwipe:!0,closeOnClick:!1})}_defaultOptionsRules(){const s={displayTime:(0,e.Nt)((0,e.ss)())?4e3:2e3,hideOnOutsideClick:!0,animation:{show:{type:"fade",duration:200,from:0,to:1},hide:{type:"fade",duration:200,from:1,to:0}}},a=[{device:h=>"phone"===h.deviceType,options:(0,u.A)({width:"calc(100vw - 40px)"},s)},{device:h=>"tablet"===h.deviceType,options:(0,u.A)({width:"auto",maxWidth:"80vw"},s)},{device:h=>(0,e.Nt)((0,e.ss)())&&"desktop"===h.deviceType,options:{minWidth:344,maxWidth:568,displayTime:4e3}}];return[...super._defaultOptionsRules(),...a]}_init(){super._init(),this._posStringToObject()}_renderContentImpl(){const{message:s,type:a}=this.option();return this._message=(0,r.A)("<div>").addClass("dx-toast-message").text(s??"").appendTo(this.$content()),this.setAria("role","alert",this._message),a&&N.includes(a.toLowerCase())&&this.$content().prepend((0,r.A)("<div>").addClass("dx-toast-icon")),super._renderContentImpl()}_render(){super._render(),this.$element().addClass("dx-toast"),this.$wrapper().addClass("dx-toast-wrapper");const{type:s}=this.option();s&&this.$content().addClass(`dx-toast-${s.toLowerCase()}`),this.$content().addClass("dx-toast-content"),this._toggleCloseEvents("Swipe"),this._toggleCloseEvents("Click")}_toggleCloseEvents(s){const a=`dx${s.toLowerCase()}`;v.A.off(this.$content(),a),this.option(`closeOn${s}`)&&v.A.on(this.$content(),a,this.hide.bind(this))}_posStringToObject(){const{position:s}=this.option();if(!(0,l.Kg)(s))return;const a=s.split(" ")[0],d=s.split(" ")[1],h=(0,u.A)({boundaryOffset:L},R[a]);switch(this.option("position",h),d){case"center":case"left":case"right":if(h&&"object"==typeof h){const O=`${h.my} ${d}`;this.option("position.at",`${h.at} ${d}`),this.option("position.my",O)}}}_show(){const s=super._show();return s.always(()=>{clearTimeout(this._hideTimeout);const{displayTime:a}=this.option();this._hideTimeout=setTimeout(this.hide.bind(this),a)}),s}_overlayStack(){return I}_zIndexInitValue(){return super._zIndexInitValue()+8e3}_dispose(){clearTimeout(this._hideTimeout),super._dispose()}_optionChanged(s){const{name:a,value:d,previousValue:h}=s;switch(a){case"type":this.$content().removeClass(`dx-toast-${h}`),d&&this.$content().addClass(`dx-toast-${String(d).toLowerCase()}`);break;case"message":this._message&&this._message.text(d);break;case"closeOnSwipe":this._toggleCloseEvents("Swipe");break;case"closeOnClick":this._toggleCloseEvents("Click");break;case"displayTime":break;default:super._optionChanged(s)}}}(0,g.A)("dxToast",P);const H=P,D=(0,f.zk)();let x=null;const M={},U={"top left":{top:10,left:10},"top right":{top:10,right:10},"bottom left":{bottom:10,left:10},"bottom right":{bottom:10,right:10},"top center":o=>({top:10,left:Math.round(o.windowWidth/2-o.toastWidth/2)}),"left center":o=>({top:Math.round(o.windowHeight/2-o.toastHeight/2),left:10}),"right center":o=>({top:Math.round(o.windowHeight/2-o.toastHeight/2),right:10}),center:o=>({top:Math.round(o.windowHeight/2-o.toastHeight/2),left:Math.round(o.windowWidth/2-o.toastWidth/2)}),"bottom center":o=>({bottom:10,left:Math.round(o.windowWidth/2-o.toastWidth/2)})},K={up:(o,s)=>({bottom:o.bottom??s.windowHeight-s.toastHeight-(o.top??0),top:"",left:o.left??"",right:o.right??""}),down:(o,s)=>({top:o.top??s.windowHeight-s.toastHeight-(o.bottom??0),bottom:"",left:o.left??"",right:o.right??""}),left:(o,s)=>({right:o.right??s.windowWidth-s.toastWidth-(o.left??0),left:"",top:o.top??"",bottom:o.bottom??""}),right:(o,s)=>({left:o.left??s.windowWidth-s.toastWidth-(o.right??0),right:"",top:o.top??"",bottom:o.bottom??""})},z=(o,s,a)=>{const d=(0,l.Qd)(o)?o:{message:o},h=(0,l.Qd)(s)?s:void 0,S=(0,l.Qd)(s)?void 0:s,{onHidden:O,onShowing:E}=d,w={onHidden:$=>{(0,r.A)($.element).remove(),O?.($)}};if(void 0!==S&&(w.type=S),void 0!==a&&(w.displayTime=a),null!=h&&h.position){const{position:$}=h,b=h.direction||(o=>(0,l.Kg)(o)&&o.includes("top")?"down-push":"up-push")($),W=(o=>M[o]||(o=>{const s=(0,r.A)("<div>").appendTo((0,p.Uq)());return M[o]=s,s})(o))((0,l.Kg)($)?$:`${$.top}-${$.left}-${$.bottom}-${$.right}`);return((o,s)=>{const a=`dx-toast-stack dx-toast-stack-${s}-direction`;o.removeAttr("class").addClass(a)})(W,b),(0,u.A)({},d,w,{container:W,_skipContentPositioning:!0,onShowing:X=>{((o,s,a)=>{const{offsetWidth:d,offsetHeight:h}=o.children().first().get(0),S={toastWidth:d,toastHeight:h,windowHeight:D.innerHeight,windowWidth:D.innerWidth},O=(0,l.Kg)(a)?((o,s)=>{const a=o?U[o]:U["bottom center"];return"function"==typeof a?a(s):a})(a,S):a,E=((o,s,a)=>{const d=o.replace(/-push|-stack/g,""),h=K[d];return h?h(s,a):{top:"",bottom:"",left:"",right:""}})(s,O,S);o.css(E)})(W,b,$),E?.(X)}})}return(0,u.A)({},d,w)},G=(o,s,a)=>{const d=z(o,s,a);x=(0,r.A)("<div>").appendTo((0,p.Uq)()),new H(x,d).show()}},5110:(C,_,n)=>{n.d(_,{A:()=>m});var u=n(8168),l=(n(9715),n(5632)),p=n(9315);let f=(()=>{class g extends p.A{_getDefaultOptions(){return(0,u.A)({},super._getDefaultOptions(),{preventScrollEvents:!1})}_getToolbarName(){return"dxToolbar"}}return g.defaultOptions=function(T){p.A.defaultOptions(T)},g})();(0,l.A)("dxPopup",f);const m=f}}]);